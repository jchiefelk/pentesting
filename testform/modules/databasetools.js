const express = require('express');
const router = express.Router();
var Client = require('mariasql'); 
var config = require('./config');
var Promise = require( 'bluebird' );
var cors = require( "cors" );
var date = new Date();
//
// Connecting to local databse instance
//
console.log( config.development );
let _store;
var connect = new Client({
  host: config.development.database.host,
  user: config.development.database.user,
  password: config.development.database.password,
  db: config.development.database.database
});

var getPendingArticles = function(item){
  return new Promise(function(resolve,reject){
            var sql = 'select * from Pending where id=?';
            var id = [item]; 
            connect.query(sql, id, function(err,rows){

                  if (err) {
                      reject(err);
                  } else {
                      resolve(rows);
                  }
            });
  });
};

var postToPending = function(item){

  return new Promise(function(resolve,reject){
      var Insert = [item.firstname, item.lastname, item.subject, item.abstract, item.article.value];
      var sql = 'insert into Pending set first_name=?, last_name=?, subject=?, abstract=?, article=?';
      connect.query(sql,Insert,function(err, rows) {
      	  
          if (err) {
            reject(err);
          }  else {
            resolve(rows.info.insertId);
          }
      });
	});

};

class DatabaseTools {
	getPendingArticleData(id) {
		return getPendingArticles(id);
	}
	postPendingArticle(item){
	 return	postToPending(item);
	}
}
module.exports = new DatabaseTools